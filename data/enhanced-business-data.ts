import type { Business } from '@/types/business';
import { palmiraDataScraper } from '@/lib/scrapers';

// Datos mock existentes
export const mockBusinesses: Business[] = [
  {
    id: 'b1',
    name: 'Panader√≠a La Espiga Dorada',
    category: 'Panader√≠a',
    address: 'Calle 27 #25-10, Zona Centro',
    phone: '3101234567',
    website: 'https://www.espigadorada.com',
    rating: 4.5,
    reviews: 120,
    description: 'Panader√≠a tradicional con m√°s de 50 a√±os de experiencia, famosa por su pan de bono y pandebono.',
    tags: ['panader√≠a', 'cafeter√≠a', 'tradicional', 'desayunos'],
    ownerName: 'Juan P√©rez',
    foundingDate: '1970-03-15',
    employeeCount: 15,
    annualRevenue: 250000,
    productsServices: ['Pan fresco', 'Pasteles', 'Caf√©', 'Desayunos'],
    socialMedia: {
      facebook: 'espigadorada',
      instagram: 'espigadorada_palmira',
    },
    status: 'active',
    zoneId: 'zone-centro',
    latitude: 3.5205,
    longitude: -76.3034,
  },
  {
    id: 'b2',
    name: 'Restaurante Sabor Casero',
    category: 'Restaurante',
    address: 'Carrera 32 #10-45, La Italia',
    phone: '3119876543',
    website: 'https://www.saborcasero.co',
    rating: 4.2,
    reviews: 85,
    description: 'Comida t√≠pica colombiana con un toque gourmet, ambiente familiar y excelente servicio.',
    tags: ['restaurante', 'comida colombiana', 'almuerzos', 'familiar'],
    ownerName: 'Mar√≠a Rodr√≠guez',
    foundingDate: '2005-07-01',
    employeeCount: 10,
    annualRevenue: 180000,
    productsServices: ['Platos del d√≠a', 'A la carta', 'Eventos'],
    socialMedia: {
      instagram: 'saborcasero_palmira',
    },
    status: 'active',
    zoneId: 'zone-la-italia',
    latitude: 3.5310,
    longitude: -76.3080,
  },
  {
    id: 'b3',
    name: 'Boutique Elegancia',
    category: 'Moda',
    address: 'Calle 30 #28-12, Zona Centro',
    phone: '3005551234',
    rating: 4.8,
    reviews: 200,
    description: 'Tienda de ropa femenina con las √∫ltimas tendencias y marcas exclusivas.',
    tags: ['moda', 'ropa femenina', 'accesorios', 'tendencias'],
    ownerName: 'Sof√≠a Giraldo',
    foundingDate: '2018-01-20',
    employeeCount: 8,
    annualRevenue: 300000,
    productsServices: ['Vestidos', 'Blusas', 'Pantalones', 'Joyas'],
    status: 'active',
    zoneId: 'zone-centro',
    latitude: 3.5210,
    longitude: -76.3025,
  },
  {
    id: 'b4',
    name: 'Gimnasio Fuerza Vital',
    category: 'Fitness',
    address: 'Avenida Ciudad de Cali #15-60, Barrio Obrero',
    phone: '3207778899',
    rating: 4.0,
    reviews: 95,
    description: 'Gimnasio moderno con equipos de √∫ltima generaci√≥n y clases grupales variadas.',
    tags: ['gimnasio', 'fitness', 'entrenamiento', 'salud'],
    ownerName: 'Carlos Duque',
    foundingDate: '2010-09-01',
    employeeCount: 12,
    annualRevenue: 220000,
    productsServices: ['Membres√≠as', 'Clases de spinning', 'Yoga', 'Pesas'],
    status: 'active',
    zoneId: 'zone-obrero',
    latitude: 3.5350,
    longitude: -76.3000,
  },
  {
    id: 'b5',
    name: 'Farmacia La Salud',
    category: 'Salud',
    address: 'Carrera 28 #12-30, La Italia',
    phone: '3154443322',
    rating: 4.3,
    reviews: 150,
    description: 'Farmacia con amplio surtido de medicamentos, productos de cuidado personal y atenci√≥n farmac√©utica.',
    tags: ['farmacia', 'salud', 'medicamentos', 'cuidado personal'],
    ownerName: 'Ana Mar√≠a V√©lez',
    foundingDate: '1995-04-01',
    employeeCount: 7,
    annualRevenue: 190000,
    productsServices: ['Medicamentos', 'Vitaminas', 'Cosm√©ticos', 'Servicios de inyecci√≥n'],
    status: 'active',
    zoneId: 'zone-la-italia',
    latitude: 3.5300,
    longitude: -76.3090,
  },
  {
    id: 'b6',
    name: 'Librer√≠a El Saber',
    category: 'Educaci√≥n',
    address: 'Calle 29 #26-05, Zona Centro',
    phone: '3012221100',
    rating: 4.7,
    reviews: 70,
    description: 'Librer√≠a independiente con una cuidada selecci√≥n de libros, papeler√≠a y eventos culturales.',
    tags: ['librer√≠a', 'libros', 'papeler√≠a', 'cultura'],
    ownerName: 'Roberto G√≥mez',
    foundingDate: '2015-11-10',
    employeeCount: 5,
    annualRevenue: 100000,
    productsServices: ['Libros', 'Cuadernos', 'Material de oficina', 'Talleres de lectura'],
    status: 'active',
    zoneId: 'zone-centro',
    latitude: 3.5220,
    longitude: -76.3040,
  },
  {
    id: 'b7',
    name: 'Caf√© Aroma y Sabor',
    category: 'Cafeter√≠a',
    address: 'Carrera 27 #18-50, Barrio Obrero',
    phone: '3189990011',
    rating: 4.6,
    reviews: 180,
    description: 'Cafeter√≠a acogedora con caf√© de origen, postres caseros y ambiente ideal para trabajar o relajarse.',
    tags: ['cafeter√≠a', 'caf√©', 'postres', 'ambiente'],
    ownerName: 'Laura Restrepo',
    foundingDate: '2019-06-01',
    employeeCount: 6,
    annualRevenue: 120000,
    productsServices: ['Caf√© especial', 'Tortas', 'Sandwiches', 'Bebidas fr√≠as'],
    status: 'active',
    zoneId: 'zone-obrero',
    latitude: 3.5340,
    longitude: -76.3010,
  },
  {
    id: 'b8',
    name: 'Veterinaria Patitas Felices',
    category: 'Servicios para Mascotas',
    address: 'Calle 15 #35-20, La Italia',
    phone: '3147776655',
    rating: 4.9,
    reviews: 100,
    description: 'Cl√≠nica veterinaria con servicios completos para el cuidado de tus mascotas, desde consultas hasta cirug√≠as.',
    tags: ['veterinaria', 'mascotas', 'salud animal', 'peluquer√≠a canina'],
    ownerName: 'Dr. Andr√©s Castro',
    foundingDate: '2012-02-28',
    employeeCount: 8,
    annualRevenue: 160000,
    productsServices: ['Consultas', 'Vacunaci√≥n', 'Cirug√≠as', 'Peluquer√≠a'],
    status: 'active',
    zoneId: 'zone-la-italia',
    latitude: 3.5320,
    longitude: -76.3070,
  },
  {
    id: 'b9',
    name: 'Tienda de Electr√≥nica TecnoMax',
    category: 'Electr√≥nica',
    address: 'Carrera 25 #20-05, Zona Centro',
    phone: '3051112233',
    rating: 3.9,
    reviews: 60,
    description: 'Amplia variedad de productos electr√≥nicos, desde celulares hasta electrodom√©sticos.',
    tags: ['electr√≥nica', 'celulares', 'electrodom√©sticos', 'tecnolog√≠a'],
    ownerName: 'Pedro Ram√≠rez',
    foundingDate: '2008-08-08',
    employeeCount: 10,
    annualRevenue: 400000,
    productsServices: ['Smartphones', 'Laptops', 'Televisores', 'Accesorios'],
    status: 'active',
    zoneId: 'zone-centro',
    latitude: 3.5230,
    longitude: -76.3050,
  },
  {
    id: 'b10',
    name: 'Florister√≠a El Jard√≠n',
    category: 'Flores y Regalos',
    address: 'Calle 20 #30-15, Barrio Obrero',
    phone: '3123334455',
    rating: 4.4,
    reviews: 45,
    description: 'Hermosos arreglos florales para toda ocasi√≥n y regalos personalizados.',
    tags: ['florister√≠a', 'flores', 'regalos', 'eventos'],
    ownerName: 'Marta Luc√≠a',
    foundingDate: '2017-05-01',
    employeeCount: 4,
    annualRevenue: 90000,
    productsServices: ['Ramos de flores', 'Plantas', 'Decoraci√≥n', 'Regalos'],
    status: 'active',
    zoneId: 'zone-obrero',
    latitude: 3.5360,
    longitude: -76.2990,
  },
];

// Datos adicionales de fuentes gubernamentales (DANE, C√°mara de Comercio, Alcald√≠a)
export const scrapedBusinesses: Business[] = [
  // DANE - Empresas oficiales
  {
    id: 'dane_001',
    name: 'Ingenio Manuelita S.A.',
    category: 'Industria Alimentaria',
    address: 'Km 15 V√≠a Palmira - Candelaria',
    phone: '3201112233',
    website: 'https://www.manuelita.com',
    rating: 0,
    reviews: 0,
    description: 'Empresa registrada en DANE - Elaboraci√≥n de az√∫car',
    tags: ['dane', 'oficial', 'elaboraci√≥n de az√∫car', 'industria'],
    ownerName: '',
    foundingDate: '',
    employeeCount: 0,
    annualRevenue: 0,
    productsServices: ['Elaboraci√≥n de az√∫car'],
    socialMedia: {},
    status: 'active',
    zoneId: 'zone-sur',
    latitude: 3.5389,
    longitude: -76.3089,
  },
  {
    id: 'dane_002',
    name: 'Comercializadora Internacional C.I. Expofruit S.A.',
    category: 'Comercio al por Mayor',
    address: 'Calle 30 #29-50',
    phone: '',
    website: '',
    rating: 0,
    reviews: 0,
    description: 'Empresa registrada en DANE - Comercio al por mayor de productos alimenticios',
    tags: ['dane', 'oficial', 'comercio al por mayor de productos alimenticios'],
    ownerName: '',
    foundingDate: '',
    employeeCount: 0,
    annualRevenue: 0,
    productsServices: ['Comercio al por mayor de productos alimenticios'],
    socialMedia: {},
    status: 'active',
    zoneId: 'zone-centro',
    latitude: 3.5395,
    longitude: -76.3034,
  },
  // C√°mara de Comercio - Empresas registradas
  {
    id: 'cc_001',
    name: 'Distribuidora La Palmira S.A.S.',
    category: 'Comercio',
    address: 'Carrera 29 #25-45, Centro',
    phone: '3145678901',
    website: 'https://www.lapalmira.co',
    rating: 0,
    reviews: 0,
    description: 'Empresa registrada en C√°mara de Comercio - Distribuci√≥n de productos de consumo masivo',
    tags: ['camara-comercio', 'registrada', 'distribuci√≥n'],
    ownerName: '',
    foundingDate: '2018-03-15',
    employeeCount: 0,
    annualRevenue: 0,
    productsServices: ['Distribuci√≥n de productos de consumo masivo'],
    socialMedia: {},
    status: 'active',
    zoneId: 'zone-centro',
    latitude: 3.5401,
    longitude: -76.3028,
  },
  {
    id: 'cc_002',
    name: 'Inversiones Tur√≠sticas del Valle Ltda.',
    category: 'Turismo',
    address: 'Calle 27 #30-12, La Italia',
    phone: '3187654321',
    website: 'https://www.turisticasvalle.com',
    rating: 0,
    reviews: 0,
    description: 'Empresa registrada en C√°mara de Comercio - Servicios de alojamiento tur√≠stico',
    tags: ['camara-comercio', 'registrada', 'servicios'],
    ownerName: '',
    foundingDate: '2020-07-22',
    employeeCount: 0,
    annualRevenue: 0,
    productsServices: ['Servicios de alojamiento tur√≠stico'],
    socialMedia: {},
    status: 'active',
    zoneId: 'zone-la-italia',
    latitude: 3.5315,
    longitude: -76.3085,
  },
  {
    id: 'cc_003',
    name: 'Panader√≠a y Reposter√≠a El Trigal',
    category: 'Alimentaci√≥n',
    address: 'Calle 25 #28-07, Centro',
    phone: '3109876543',
    website: '',
    rating: 0,
    reviews: 0,
    description: 'Empresa registrada en C√°mara de Comercio - Elaboraci√≥n de productos de panader√≠a',
    tags: ['camara-comercio', 'registrada', 'elaboraci√≥n'],
    ownerName: '',
    foundingDate: '2015-11-08',
    employeeCount: 0,
    annualRevenue: 0,
    productsServices: ['Elaboraci√≥n de productos de panader√≠a'],
    socialMedia: {},
    status: 'active',
    zoneId: 'zone-centro',
    latitude: 3.5388,
    longitude: -76.3041,
  },
  // Alcald√≠a - Licencias de funcionamiento
  {
    id: 'alc_001',
    name: 'Supermercado San Andr√©s',
    category: 'Supermercado',
    address: 'Carrera 31 #15-23, Centro',
    phone: '3201234567',
    website: '',
    rating: 0,
    reviews: 0,
    description: 'Establecimiento con licencia municipal - Venta al por menor de productos alimenticios',
    tags: ['alcaldia', 'licenciado', 'alimenticio', 'vigente'],
    ownerName: 'Carlos Mendoza',
    foundingDate: '2024-01-15',
    employeeCount: 0,
    annualRevenue: 0,
    productsServices: ['Venta al por menor de productos alimenticios'],
    socialMedia: {},
    status: 'active',
    zoneId: 'zone-centro',
    latitude: 3.5402,
    longitude: -76.3031,
  },
  {
    id: 'alc_002',
    name: 'Restaurante La Hacienda',
    category: 'Restaurante',
    address: 'Calle 26 #32-15, La Italia',
    phone: '3156789012',
    website: '',
    rating: 0,
    reviews: 0,
    description: 'Establecimiento con licencia municipal - Servicios de restaurante y bar',
    tags: ['alcaldia', 'licenciado', 'restaurante', 'vigente'],
    ownerName: 'Ana Patricia G√≥mez',
    foundingDate: '2024-02-10',
    employeeCount: 0,
    annualRevenue: 0,
    productsServices: ['Servicios de restaurante y bar'],
    socialMedia: {},
    status: 'active',
    zoneId: 'zone-la-italia',
    latitude: 3.5316,
    longitude: -76.3078,
  },
  {
    id: 'alc_003',
    name: 'Ferreter√≠a El Martillo',
    category: 'Ferreter√≠a',
    address: 'Carrera 28 #20-08, Norte',
    phone: '3112345678',
    website: '',
    rating: 0,
    reviews: 0,
    description: 'Establecimiento con licencia municipal - Venta de herramientas y materiales de construcci√≥n',
    tags: ['alcaldia', 'licenciado', 'ferreteria', 'vencida'],
    ownerName: 'Jos√© Luis Ram√≠rez',
    foundingDate: '2023-11-20',
    employeeCount: 0,
    annualRevenue: 0,
    productsServices: ['Venta de herramientas y materiales de construcci√≥n'],
    socialMedia: {},
    status: 'closed',
    zoneId: 'zone-norte',
    latitude: 3.5455,
    longitude: -76.3018,
  },
  {
    id: 'alc_004',
    name: 'Peluquer√≠a Estilo y Belleza',
    category: 'Servicios de Belleza',
    address: 'Calle 24 #29-12, Centro',
    phone: '3189876543',
    website: '',
    rating: 0,
    reviews: 0,
    description: 'Establecimiento con licencia municipal - Servicios de peluquer√≠a y est√©tica',
    tags: ['alcaldia', 'licenciado', 'belleza', 'vigente'],
    ownerName: 'Mar√≠a Elena Vargas',
    foundingDate: '2024-03-05',
    employeeCount: 0,
    annualRevenue: 0,
    productsServices: ['Servicios de peluquer√≠a y est√©tica'],
    socialMedia: {},
    status: 'active',
    zoneId: 'zone-centro',
    latitude: 3.5399,
    longitude: -76.3029,
  },
];

// Funci√≥n para obtener todos los negocios (mock + scraped)
export function getAllBusinesses(): Business[] {
  return [...mockBusinesses, ...scrapedBusinesses];
}

// Funci√≥n para obtener negocios por fuente
export function getBusinessesBySource(source: 'mock' | 'dane' | 'camara-comercio' | 'alcaldia'): Business[] {
  switch (source) {
    case 'mock':
      return mockBusinesses;
    case 'dane':
      return scrapedBusinesses.filter(b => b.id.startsWith('dane_'));
    case 'camara-comercio':
      return scrapedBusinesses.filter(b => b.id.startsWith('cc_'));
    case 'alcaldia':
      return scrapedBusinesses.filter(b => b.id.startsWith('alc_'));
    default:
      return [];
  }
}

// Funci√≥n para obtener estad√≠sticas de los datos
export function getDataStatistics() {
  const allBusinesses = getAllBusinesses();
  const daneBusinesses = getBusinessesBySource('dane');
  const camaraBusinesses = getBusinessesBySource('camara-comercio');
  const alcaldiaBusinesses = getBusinessesBySource('alcaldia');
  
  return {
    total: allBusinesses.length,
    mock: mockBusinesses.length,
    scraped: scrapedBusinesses.length,
    bySource: {
      dane: daneBusinesses.length,
      camaraComercio: camaraBusinesses.length,
      alcaldia: alcaldiaBusinesses.length,
    },
    active: allBusinesses.filter(b => b.status === 'active').length,
    closed: allBusinesses.filter(b => b.status === 'closed').length,
    new: allBusinesses.filter(b => b.status === 'new').length,
  };
}

// Funci√≥n para actualizar datos mediante scraping
export async function updateScrapedData(): Promise<Business[]> {
  try {
    console.log('üîÑ Iniciando actualizaci√≥n de datos...');
    const results = await palmiraDataScraper.scrapeAllSources();
    
    console.log('‚úÖ Datos actualizados:', {
      total: results.combined.length,
      dane: results.dane.length,
      camaraComercio: results.camaraComercio.length,
      alcaldia: results.alcaldia.length,
    });
    
    return results.combined;
  } catch (error) {
    console.error('‚ùå Error al actualizar datos:', error);
    return scrapedBusinesses; // Retornar datos mock en caso de error
  }
}

// Exportar datos existentes para compatibilidad
export { mockBusinesses as businesses };
export default getAllBusinesses();